# 2.28链表随机节点

## 题目：

给你一个单链表，随机选择链表的一个节点，并返回相应的节点值。每个节点 **被选中的概率一样** 。

实现 `Solution` 类：

- `Solution(ListNode head)` 使用整数数组初始化对象。
- `int getRandom()` 从链表中随机选择一个节点并返回该节点的值。链表中所有节点被选中的概率相等。

 

**示例：**

```
输入
["Solution", "getRandom", "getRandom", "getRandom", "getRandom", "getRandom"]
[[[1, 2, 3]], [], [], [], [], []]
输出
[null, 1, 3, 2, 2, 3]

解释
Solution solution = new Solution([1, 2, 3]);
solution.getRandom(); // 返回 1
solution.getRandom(); // 返回 3
solution.getRandom(); // 返回 2
solution.getRandom(); // 返回 2
solution.getRandom(); // 返回 3
// getRandom() 方法应随机返回 1、2、3中的一个，每个元素被返回的概率相等。
```

## 代码：

### 个人解法：

```java
class Solution {

     ArrayList<Integer> list;


    public Solution(ListNode head) {
        list = new ArrayList<>();
        while (head != null) {
            list.add(head.val);
            head = head.next;
        }
    }

    public int getRandom() {
        Random random = new Random();
        int i = random.nextInt(list.size());
        Integer i1 = list.get(i);
        return  i1;
    }
}
```

### 蓄水池解法：

```java
class Solution {
    ListNode head;
    Random random = new Random(20220116);
    public Solution(ListNode _head) {
        head = _head;
    }
    public int getRandom() {
        int ans = 0, idx = 0;
        ListNode t = head;
        while (t != null && ++idx >= 0) {
            if (random.nextInt(idx) == 0) ans = t.val;
            t = t.next;
        }
        return ans;
    }
}

```

## 题解：

### 个人方法：

用一个Arrlist把数据写进去，再获得list的长度，通过Random获取0到length的随机值，即可获取相同概率的值

### 蓄水池：可以减少内存使用

整理题意：总的样本数量未知，从所有样本中抽取若干个，要求每个样本被抽到的概率相等。

具体做法为：从前往后处理每个样本，每个样本成为答案的概率为  1/i
​
 ，其中 i 为样本编号（编号从 1 开始），最终可以确保每个样本成为答案的概率均为  1/n
​
 （其中 n 为样本总数）。

容易证明该做法的正确性，假设最终成为答案的样本编号为 k，那么 k 成为答案的充要条件为「在遍历到 k 时被选中」并且「遍历大于 k 的所有元素时，均没有被选择（没有覆盖 k）」。

因此，在每一次 getRandom 时，从前往后处理每个节点，同时记录当前节点的编号，当处理到节点 k 时，在 [0,k) 范围内进行随机，若随机到结果为 0（发生概率为  
1/k），则将节点 k 的值存入答案，最后一次覆盖答案的节点即为本次抽样结果。

